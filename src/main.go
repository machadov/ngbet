package main

import (
	"fmt"
	"math"

	"gonum.org/v1/gonum/mat"
)

func main() {
	W := mat.NewDense(40, 1, []float64{
		8.27173516e-02,
		1.10541552e-01,
		6.95866272e-02,
		8.81155670e-01,
		1.77493319e-01,
		8.67342353e-02,
		3.92892994e-02,
		6.81846344e-04,
		5.17368899e-04,
		5.39300032e-04,
		-9.78800189e-03,
		5.85713312e-02,
		6.26042843e-01,
		1.01009011e+00,
		2.83224165e-01,
		-2.41606489e-01,
		-4.03864793e-02,
		-6.41123438e-03,
		2.36779347e-01,
		-6.65536821e-01,
		-1.02196574e-01,
		-3.93382221e-01,
		-3.10864169e-02,
		2.98097786e-02,
		1.42930135e-01,
		-3.97605501e-04,
		-3.47402529e-04,
		3.01471772e-03,
		-2.87759416e-02,
		-7.42398351e-02,
		-1.83466300e-01,
		-3.67188662e-01,
		-6.29819632e-01,
		2.84140646e-01,
		5.35171770e-04,
		3.11689824e-03,
		-5.00448793e-02,
		7.13185489e-01,
		-3.67122948e-01,
		-2.89085835e-01,
	})

	b := 0.3038962
	c := mat.NewDense(1, 40, []float64{
		1, 0, 1, 0, 0, 1.275, 3.55, 201, 1.04, 13, 1.5, 7.8, 1.09, -0.25, 2.2, 1.65, 2.875, 4.75, 1.909090909, 0.75, 1.9, 1.9, -0.25, 2.45, 1.575, 3.4, 6.5, 1.615384615, 2.5, 2.15, 1.725, -0.5, 2.05, 1.8, 2, 4.2, 3.1, 1.75, 1.775, 2.1,
	})

	out := &mat.Dense{}
	out.Mul(c, W)

	fmt.Println(out)
	ar, ac := out.Dims()
	for i := 0; i < ar; i++ {
		for j := 0; j < ac; j++ {
			v := out.At(i, j) + b
			v = 1.0 / (1.0 + math.Exp(-v))
			out.Set(i, j, v)
		}
	}
	fmt.Println(out.At(0, 0))
}
